from langchain.docstore.document import Document
import pandas as pd
from typing import List
from numpy import nan
import ast 

def load_docs(docs_path) -> List[Document]:
    """
    Load documents from the website extracts csv generated by the 
    data processing pipeline 
    """
    docs_df = pd.read_csv(docs_path,index_col=0)
    docs_df[['faculty','program','specialization']] = docs_df[['faculty','program','specialization']].replace(nan, 'None')
    docs = []
    for (idx,row) in docs_df.iterrows():
        doc = Document(page_content=row['text'],
                       metadata={
                          **row,
                          'titles': ast.literal_eval(row['titles']),
                          'parent_titles': ast.literal_eval(row['parent_titles']),
                          'links': ast.literal_eval(row['links'])})
        docs.append(doc)

    return docs